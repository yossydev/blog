---
title: "JavaScriptランタイムの歴史からみるNode.js strip-typeが入るまで"
description: "a"
date: "2024/12/18"
updatedAt: "2024/12/18"
path: "node-js-strip-types"
published: true
---

## Intro

Node.jsの[--experimental-strip-types](https://nodejs.org/docs/v22.12.0/api/cli.html#--experimental-strip-types)というフラグについてご存知でしょうか。
このフラグを有効にすることで、Node.jsでTypeScriptファイルが実行できるようになります。

本記事では、おそらくブラウザを除いたJavaScriptランタイムの中では、もっとも使われているNode.jsが、今回のサポートを行うまで、今後の動き、
そして最も主要な、ブラウザというランタイムでTypeScriptファイルが実行できることはあるのか。ということについて考えていきたいと思います。

## 前提

- JavaScriptは素晴らしい言語
- 筆者は、できればTypeScriptを使わずJavaScriptを生で書きたいと思っている人

## TypeScriptを使った開発が当たり前に

現代の開発において、フロントエンドでもバックエンドでも、JavaScriptを生で書かず、TypeScriptで書かれることが多くなりました。
JavaScriptで書かれたNode.jsサーバー、大量のコンポーネントが存在するのにpropsに一切の保管が効かない（props-typesは除く）Reactアプリなど、考えるのも怖いと思います。

さらに、ReactやNext.js、Vue.jsやNuxt.jsといったフレームワークたちによって、コンパイルするためにtsconfigを細かく制御したりせずとも、アプリケーションの開発はできるようになってきました。

このおかげで、確実にアプリケーション開発はしやすくなっていると思っています。

しかし、TypeScriptはそのままでは動きません。必ず最終的にはJavaScriptにコンパイルされます。
なので初期の頃は、tscで自分でコンパイルして、そこで出力されたJavaScriptファイル・ディレクトリをentry pointとし、アプリケーションを動かす、みたいなことをする必要がありました。

けどもうそれは過去の話になろうとしています。というかもうなっています。

ここからは、Node.jsの強豪のなるDeno, Bunを見ていきつつ、最後にNode.jsの動きも見ていきます。

## Denoの誕生

[https://deno.com/](https://deno.com/)

Node.jsの生みの親、ライアンダールが作ったのがDenoです。
ちなみにDenoはNodeの単語をもじっています。そしてこれは、TypeScriptランタイムだと書いてあります。

これは[Design Mistakes in Node](https://tinyclouds.org/jsconf2018.pdf)という有名な反省文があると思いますが、こちらを解消しつつ、生まれたものになってます。
ただ2024年Denoバージョンの反省文もそういえば出ていたような気がしますが。

TypeScriptランタイムだと言っているように、DenoではTypeScriptファイルがそのまま動きます。
以下は[公式ドキュメント](https://docs.deno.com/runtime/)のものです。

```ts
// main.ts
function greet(name: string): string {
  return `Hello, ${name}!`;
}

console.log(greet("world"));
```

```
$ deno main.ts
Hello, world!
```

## Bunの登場

- （多分）2代目ランタイムTSサポート
- 内部では〇〇で動いている
- 個人的には暴走列車として暴れ回っているのを見ている分には面白いので好き。

## Node.js strip-typeの誕生

- https://nodejs.org/docs/v22.12.0/api/typescript.html#type-stripping
- きっと全人類が待ち侘びた機能（？）

## ブラウザのTSサポート

- https://www.reddit.com/r/webdev/comments/xecvqe/browsers_should_support_typescript_natively/
- https://stackoverflow.com/questions/22885955/typescript-support-in-modern-browsers