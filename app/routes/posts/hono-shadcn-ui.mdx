---
title: "HonoXã§shadcn/uiã‚’ä½¿ç”¨ã™ã‚‹"
description: "HonoXã§shadcn/uiã‚’ä½¿ã†æ©Ÿä¼šãŒã‚ã‚Šã€ãã®éš›ã«è‹¦æˆ¦ã—ãŸãƒã‚¤ãƒ³ãƒˆãªã©ã‚’æ›¸ãã¾ã—ãŸã€‚"
date: "2024/03/26"
published: true
---

## Intro

Honoã¯[react-renderer](https://github.com/honojs/middleware/tree/main/packages/react-renderer)ã¨ã„ã†middlewareã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚’ä½¿ç”¨ã™ã‚Œã°ReactãŒå‹•ãã¾ã™ã€‚ã™ã”ã„ã€‚

ãã—ã¦æœ€è¿‘ã®UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç³»ã§äººæ°—ãªshadcn/uiã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯Reactã«ä¾å­˜ã—ã¦ã„ã‚‹ã®ã§å…ˆã»ã©ã®middlewareã®å‡ºç•ªã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚
æœ€è¿‘ã“ã®UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’HonoXã§ä½¿ã„ãŸã„ã¨ã„ã†ã“ã¨ãŒã‚ã‚Šã€ãã®éš›ã«è‹¦æˆ¦ã—ãŸãƒã‚¤ãƒ³ãƒˆãªã©ã‚’ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚

## Repository

[https://github.com/yossydev/honox-shadcn](https://github.com/yossydev/honox-shadcn)ã¨ã„ã†ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œã£ã¦ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’å‚è€ƒã«ã—ã¦ã„ãŸã ã‘ã‚Œã°ç°¡å˜ã«ã—ã¦ã„ãŸã ã‘ã‚Œã°ç’°å¢ƒä½œã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚
å®Ÿéš›ã«å‹•ä½œè¦‹ã¦ã¿ãŸã„æ–¹ã¯cloudflare pageã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã‚ã‚‹ã®ã§ã€[https://honox-shadcn.pages.dev/](https://honox-shadcn.pages.dev/)ã§ã¿ã‚Œã¾ã™ã€‚

## è‹¦æˆ¦ã—ãŸã¨ã“ã‚

HonoXã®READMEã«[reactRenderer](https://github.com/honojs/honox?tab=readme-ov-file#react-case)ã®ä½¿ã„æ–¹ãŒã‚ã‚‹ã‚“ã§ã™ãŒã€ãã“ã«æ›¸ã„ã¦ã‚ã‚‹å†…å®¹ã ã‘ã§ã¯å‹•ã‹ãªã‹ã£ãŸã®ã§ã€ã„ãã¤ã‹è‡ªåˆ†ã®æ–¹ã§æ›¸ã„ã¦ãŠãã¾ã™ã€‚

### vite.config.tsã«ssrã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 

```ts
ssr: { external: ["react", "react-dom"] },
```

reactã¨react-domã‚’ssrã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚åŸºæœ¬htmlã¨cssã¯ssrã§äº‹å‰ã«ç”Ÿæˆã—ãŸã‚‚ã®ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æ¸¡ã—ã¦ã„ã‚‹ã®ã§ã€ãã®ç”Ÿæˆæ™‚ã«reactã¨react-domã‚’å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦å«ã‚ã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```bash
[vite] Error when evaluating SSR module /~~~~/node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js:
|- ReferenceError: module is not defined
```

è¨­å®šã—ã¦ã„ãªã„ã¨ã“ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚

### HasIslandãŒå‹•ã‹ãªã„

åŸºæœ¬HonoXã‚’ä½¿ã†æ–¹ã¯Scriptã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€ãã®å†…éƒ¨ã«ã¯HasIslandã¨ã„ã†ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ã£ã¦ã€scriptã‚’èª­ã¿è¾¼ã‚€ã‹ã©ã†ã‹ã®ãƒã‚§ãƒƒã‚¯ã‚’è¡Œãªã£ã¦ã„ã¾ã™ã€‚

HasIslandã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå®Ÿè£…ã«ãªã£ã¦ã„ã¾ã™

```tsx
import type { FC } from 'hono/jsx'
import { useRequestContext } from 'hono/jsx-renderer'
import { IMPORTING_ISLANDS_ID } from '../../constants.js'

export const HasIslands: FC = ({ children }) => {
  const c = useRequestContext()
  return <>{c.get(IMPORTING_ISLANDS_ID) ? children : <></>}</>
}
```

ã“ã“ã§å•é¡Œãªã®ãŒã€ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒ`hono/jsx-renderer`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã¨ã“ã‚ã§ã™ã€‚

reactRendererã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯`@hono/react-renderer`ã®`useRequestContext`ã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹ã®ã§ã€HasIslandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å‹•ã‹ãšã›ã£ã‹ãã®islandã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãŒæ„å‘³ã‚’ãªã•ãªããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

```tsx
import { reactRenderer } from "@hono/react-renderer";
import { useRequestContext } from "@hono/react-renderer";
import { FC, PropsWithChildren } from "react";

const HasIslands: FC<PropsWithChildren> = ({ children }) => {
  const IMPORTING_ISLANDS_ID = "__importing_islands" as const;
  const c = useRequestContext();
  return <>{c.get(IMPORTING_ISLANDS_ID) ? children : <></>}</>;
};
```

å›é¿ç­–ã¨ã—ã¦ã€è‡ªåˆ†ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚Œã°islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ©Ÿèƒ½ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

`__importing_islands`ã¨ã„ã†å®šæ•°ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«islandãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®importãŒã‚ã‚Œã°ä»˜ãè­˜åˆ¥å­ã§ã™ã€‚ãã‚Œã‚’ä½¿ã£ã¦`c.get(IMPORTING_ISLANDS_ID)`ã¨getã™ã‚‹ã“ã¨ã§islandã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒimportã•ã‚Œã¦ã„ã‚Œã°trueãŒè¿”ã£ã¦ãã‚‹ã¿ãŸã„ãªä»•çµ„ã¿ã«ãªã£ã¦ã„ã¾ã™ã€‚
ã“ã“ã‚‰è¾ºã¯ä»¥å‰ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã—ãŸéš›ã®çŸ¥è¦‹ãŒæ´»ãã¦ã„ã¾ã™ğŸ’ª [feat: preserved file island support #114](https://github.com/honojs/honox/pull/114)

ã“ã®ä»¶ã«é–¢ã—ã¦ã¯[Creating HasIslands component with useRequestContext in react-renderer #127](https://github.com/honojs/honox/issues/127)ã§issueã‚’å‡ºã—ã¾ã—ãŸã€‚

### client.tsã§å‹ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹

READMEã«ã‚ˆã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«`client.ts`ã‚’ã™ã‚‹ã‚ˆã†ã«æ›¸ã„ã¦ã‚ã‚Šã¾ã™

```tsx
import { createClient } from "honox/client";

createClient({
  hydrate: async (elem, root) => {
    const { hydrateRoot } = await import("react-dom/client");
    hydrateRoot(root, elem);
  },
  createElement: async (type: any, props: any) => {
    const { createElement } = await import("react");
    return createElement(type, props);
  },
});
```

ã—ã‹ã—ã“ã‚Œã ã¨TSã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™
```bash
app/client.ts:6:23 - error TS2345: Argument of type 'Node' is not assignable to parameter of type 'ReactNode'.

6     hydrateRoot(root, elem);
                        ~~~~

app/client.ts:8:3 - error TS2322: Type '(type: any, props: any) => Promise<React.CElement<any, React.Component<any, any, any>>>' is not assignable to type 'CreateElement'.
  Type 'Promise<CElement<any, Component<any, any, any>>>' is not assignable to type 'Node | Promise<Node>'.
    Type 'Promise<CElement<any, Component<any, any, any>>>' is not assignable to type 'Promise<Node>'.
      Type 'ComponentElement<any, Component<any, any, any>>' is missing the following properties from type 'Node': baseURI, childNodes, firstChild, isConnected, and 46 more.

8   createElement: async (type: any, props: any) => {
    ~~~~~~~~~~~~~
```

ã“ã®å•é¡Œã‚‚ã™ã§ã«issueãŒã‚ã‚Šæ—¢çŸ¥ã®å•é¡Œã¿ãŸã„ãªã®ã§ã€ãã®ã†ã¡ç›´ã•ã‚Œã‚‹ã¨æ€ã„ã¾ã™([Type Error Occurs When Trying to Use React with createClient #87](https://github.com/honojs/honox/issues/87))

### SSGã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹

```bash
TypeError: __vite_ssr_import_0__.jsxDEV is not a function
```

â†‘ ã®ã‚ˆã†ã«SSGã‚’ä½¿ã†ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚ã“ã‚ŒãŒã‚ã‚“ã¾ã‚Šã‚ã‹ã£ã¦ãªãã¦ã€ä¸€æ—¦SSGã—ãªã„ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã‚“ã§ã™ãŒã€ã¾ãŸã©ã“ã‹ã§èª¿ã¹ã¦ã¿ãŸã„ã§ã™ã€‚

## ã¾ã¨ã‚

ã„ãã¤ã‹è‹¦æˆ¦ãƒã‚¤ãƒ³ãƒˆä¸Šã’ã¾ã—ãŸãŒã€ã“ã‚Œä»¥å¤–ã¯ç‰¹ã«ãªãã¦ã€åŸºæœ¬ç’°å¢ƒæ§‹ç¯‰ã‚‚shadcn/uié€šã‚Šã«é€²ã‚ã‚Œã°ã§ãã‚‹ã®ã§ã¨ã£ã¦ã‚‚è‰¯ã„ã§ã™ã€‚

## é–¢é€£

- [https://github.com/yossydev/honox-shadcn](https://github.com/yossydev/honox-shadcn) 
- [react-renderer](https://github.com/honojs/middleware/tree/main/packages/react-renderer)
- [react-case](https://github.com/honojs/honox?tab=readme-ov-file#react-case)
- [Creating HasIslands component with useRequestContext in react-renderer #127](https://github.com/honojs/honox/issues/127)
- [Type Error Occurs When Trying to Use React with createClient #87](https://github.com/honojs/honox/issues/87)
